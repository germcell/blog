<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" th:href="@{/res/favicon.ico}">
    <title th:text="${blog.title}">详情</title>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css"> -->
    <link rel="stylesheet" href="../static/css/semantic.min.css" th:href="@{/res/css/semantic.min.css}">
    <link rel="stylesheet" href="../static/dist/components/icon.min.css" th:href="@{/res/dist/components/icon.min.css}">
    <link rel="stylesheet" href="../static/css/typo.css" th:href="@{/res/css/typo.css}">
    <link rel="stylesheet" href="../static/lib/animate/animate.css" th:href="@{/res/lib/animate/animate.css}">
    <link rel="stylesheet" href="../static/lib/prism/prism.css" th:href="@{/res/lib/prism/prism.css}">
    <link rel="stylesheet" href="../static/lib/tocbot/tocbot.css" th:href="@{/res/lib/tocbot/tocbot.css}">
    <link rel="stylesheet" href="../static/css/index.css" th:href="@{/res/css/index.css}">
</head>
<body>
    <!-- 导航 -->
    <div th:include="common :: nav(1)"></div>

    <!-- 主体内容 -->
    <div id="waypoint" class="m-content m-padding-big animated fadeIn" style="padding-bottom: 5em !important;">
        <div class="ui  segments">
            <div class="ui segment">
                <!--   作者、文章基本信息  -->
                <div class="m-user-info-flex">
                    <div class="ui m-avatar" style="font-size: 1.6em !important; margin-right: 1em;">
                        <a href="#" target="_blank">
                            <img src="https://picsum.photos/id/1012/100/100" class="ui avatar image" alt="" th:src="${blog.user.avatar}">
                            <span th:text="${blog.user.nickname}"> Marry </span>
                        </a>
                    </div>
                    <div class="m-view-info">
                        <i class="icon clock"></i>于 <span th:text="${#dates.format(blog.writeTime, 'yyyy-MM-dd HH:mm')}">2022.2.18 12:23</span> 发布
                    </div>
                    <div class="m-view-info">
                        <i class="icon eye"></i><span th:text="${blog.views}">232</span>
                    </div>
                    <div class="m-view-info">
                        <i class="icon thumbs up"></i>点赞: <span>21</span>
                    </div>
                    <div class="ui teal tag label m-view-cr-info">
                        <span th:text="${blog.category.name}">时事</span>
                    </div>

                </div>
            </div>
            <div class="ui segment" th:if="${blog.firstPicture == null || blog.firstPicture == ''}">
                <img src="../static/images/blogPicture/del_blog_img1.jpg" alt="" class="ui fluid rounded image" style="height: 457px;" th:src="@{/res/images/blogPicture/del_blog_img1.jpg}">
            </div>
            <div class="ui segment" th:if="${blog.firstPicture != null && blog.firstPicture != ''}">
                <img src="../static/images/blogPicture/del_blog_img1.jpg" alt="" class="ui fluid rounded image" style="height: 457px;" th:src="${blog.firstPicture}">
            </div>
            <!-- 内容 -->
            <div class="ui segment">
                <div style="position: relative;">
                    <h2 class="ui center aligned header m-diy-title" th:text="${blog.title}">
                        北京冬奥会闭幕
                    </h2>
                    <div class="ui orange basic label m-copyright-position" th:text="${blog.copyright.crTip}">原创</div>
                </div>
                <div class="typo typo-selection js-toc-content m-diy-content" th:utext="${blog.content}">

                    <!--/*-->
                    <div class="typo type-selection m-blog-content js-toc-content">
                        <h3>1、开篇</h3>
                        <h4>1.1</h4>
                        fsadf
                        <h4>1.2</h4>
                        fsaf
                        <p>
                            20日晚，冬奥会闭幕式，将在国家体育场“鸟巢”正式亮相。
                            开闭幕式团队在接受专访时透露，闭幕式依然遵循“简约”风格，与开幕式形成“一脉相承”的叙事模式，通过仪式与表演的有机融合，将再次呈现中国式浪漫。
                            此外，还会通过“穿越”来呈现和致敬“双奥之城”这一重要元素。目前，闭幕式各项准备工作已经就绪。
                        </p>
                        <h4>2、引入</h4>

                        <!--****使用代码高亮时，一定要不要再pre、code两个标签内写空格和换行，会影响排版******  -->
                        <pre><code class="language-java">
public void main(String[] args) {
    int a = 2;
    int b = 3;
    System.out.println("hello prism");
}</code></pre>

                        <h4>3、高潮</h4>
                        <p>
                            有网友表示，这改革好！没有明星没有演员，几乎没有专业演员参加，强调群众性，演员队伍几乎全部都是来自大中小学。为张导点赞！北京冬奥会，将会是历史上举办最成功的一届冬奥会！再一次让世界瞩目中国！
                            闭幕式延续开幕式“简约而精彩”的风格，这是属于中国人的浪漫仪式感。
                        </p>
                        <h4>4、回味</h4>
                        <p>
                            何其有幸，让我们再一次见证最美的中国风采，为伟大的祖国自豪！闭幕不落幕，青春恰时来，生命不止，运动不息，米兰冬奥会再见！
                            双奥之城，唯美北京；冰雪之约，温暖礼成；红色之光，点燃激情；蓝色梦幻，浪漫无穷；如此成功，党指航行；团结一心，众志成城；联谊五洲，影响全球；历史五千，彰显文明。祝2022年北京冬奥会圆满成功！祝北京冬奥会闭幕式精彩礼成！
                            世界瞩目，精彩纷呈，这次我们向世界展现了中国的科技，人文和勇于拼搏的精神！闭幕式体现中国红！浪漫蓝！双奥之城体现各种元素！必将传遍全球！让我们一起奔向未来！祝贺冬奥会圆满成功！
                        </p>
                    </div>
                    <!--*/-->

                </div>
            </div>

            <!-- 赞赏、查看留言 -->
            <div id="leave-messsage" class="ui center aligned segment" th:if="${blog.isAppreciate == true || blog.isComment == true}">
                <button id="comment" class="ui basic circular button" data-blogid="" th:data-blogid="${blog.bid}" th:if="${blog.isComment == true}">查看留言</button>
                <button id="appreciate" class="ui orange basic circular button" th:if="${blog.isAppreciate == true}">赞赏</button>
            </div>
            <!-- 赞赏二维码 -->
            <div class="ui showQR flowing popup transition hidden">
                <div class="ui orange basic label">
                    <div class="ui images rounded center aligned"  style="font-size: inherit;">
                        <div class="image">
                            <img src="../static/images/wechat.png" th:src="@{/res/images/wechat.png}" class="ui rounded bordered image" style="width: 90px; height: 90px;">
                        </div>
                        <div class="image">
                            <img src="../static/images/wechat.png" th:src="@{/res/images/wechat.png}" class="ui rounded bordered image" style="width: 90px; height: 90px;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 留言区域-->
            <div class="m-show-comment" style="display: none; font-family: 'Arial','Microsoft YaHei','黑体','宋体',sans-serif;">
                <div class="ui teal segment">
                    <div class="ui comments">
                        <h3 class="ui dividing header" style="width: 125% !important;">留言栏</h3>
                        <!--      留言模板         -->
                        <div id="comment-fresh">
                            <div class="comment" th:fragment="commentList" th:each="comment:${comments}">
                            <a class="avatar">
                                <img src="../static/images/commentAvatar/avatar22.jpg" th:src="${comment.avatar}">
                            </a>
                            <div class="content">
                                <a class="author" th:text="${comment.nickname}">Matt</a>
                                <div class="metadata">
                                    <span class="date" th:text="${#dates.format(comment.replyTime,'yyyy-MM-dd HH:mm:ss')}">今天下午 5:42</span>
                                </div>
                                <div class="text m-comment-is-pass" th:text="${comment.isPass eq true ? comment.content : comment.passContent}" th:classappend="${comment.isPass eq false} ? 'm-comment-no-pass'">太赞了！ </div>
                                <div class="actions">
                                    <a class="reply" onclick="reply(this)" data-comid="" data-replynickname="" data-commentparentid="" th:data-commentparentid="${comment.comParentId}" th:data-replynickname="${comment.nickname}" th:data-comid="${comment.comId}">回复</a>
                                </div>
                            </div>
                            <div class="comments" th:if="${comment.listChildComments != null}" style="padding-top: 0.5em!important;padding-bottom: 0.5em!important;">
                                <div class="comment" th:each="childComment:${comment.listChildComments}">
                                    <a class="avatar">
                                        <img src="../static/images/commentAvatar/avatar23.jpg" th:src="${childComment.avatar}">
                                    </a>
                                    <div class="content">
                                        <a class="author" th:text="${childComment.nickname}">Jenny Hess</a>
                                        <div class="metadata">
                                            <span class="date" th:text="${#dates.format(childComment.replyTime, 'yyyy-MM-dd HH:mm:ss')}">刚刚</span>
                                        </div>
                                        <div class="text m-comment-is-pass" th:text="${childComment.isPass eq true ? childComment.content : childComment.passContent}" th:classappend="${childComment.isPass eq false} ? 'm-comment-no-pass'">艾略特你永远是多么正确 :) </div>
                                        <!-- TODO 留言二级回复
                                        <div class="action">
                                            <a class="reply">回复</a>
                                        </div>
                                        -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>

                        <!--/*-->
                        <div class="comment">
                          <a class="avatar">
                            <img src="../static/images/commentAvatar/avatar23.jpg" th:src="@{/res/images/del_avatar.jpg}">
                          </a>
                          <div class="content">
                            <a class="author">Elliot Fu</a>
                            <div class="metadata">
                              <span class="date">昨天上午12:30</span>
                            </div>
                            <div class="text">
                              <p>這對我的研究是非常有用.謝謝!</p>
                            </div>
                            <div class="actions">
                              <a class="reply">回复</a>
                            </div>
                          </div>
                          <div class="comments">
                            <div class="comment">
                              <a class="avatar">
                                <img src="../static/images/commentAvatar/avatar23.jpg" th:src="@{/res/images/del_avatar.jpg}">
                              </a>
                              <div class="content">
                                <a class="author">Jenny Hess</a>
                                <div class="metadata">
                                  <span class="date">刚刚</span>
                                </div>
                                <div class="text">艾略特你永远是多么正确 :) </div>
                                <div class="actions">
                                  <a class="reply">回复</a>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="comment">
                          <a class="avatar">
                            <img src="../static/images/commentAvatar/avatar23.jpg" th:src="@{/res/images/del_avatar.jpg}">
                          </a>
                          <div class="content">
                            <a class="author">Joe Henderson</a>
                            <div class="metadata">
                              <span class="date">5 天以前</span>
                            </div>
                            <div class="text">老兄，这太棒了。非常感谢。 </div>
                            <div class="actions">
                              <a class="reply">回复</a>
                            </div>
                          </div>
                        </div>
                        <!--*/-->
                      </div>
                </div>
                <!-- 提交留言 -->
                <div class="ui grey segment" th:if="${blog.isComment == true}">
                    <div id="comment-form" class="ui form">
                        <input type="hidden" name="comParentId" value="-1">
                        <input type="hidden" name="bid" value="" th:value="${blog.bid}">
                        <div class="field">
                            <textarea name="content" id="" cols="30" rows="5"  style="resize: none;" placeholder="发表你的看法吧..."></textarea>
                        </div>
                        <div class="fields">
                            <div class="field">
                                <input type="text" name="nickname" placeholder="👽你的姓名">
                            </div>
                            <div class="field">
                                <input type="text" name="mail" placeholder="📮你的邮箱地址">
                            </div>
                            <div class="ui field right aligned">
                                <button id="comment-submit-btn" type="button" class="ui secondary button">发表</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>  
    </div>

    <!-- 侧边快速导航 -->
    <div id="toolbar" class="m-quicknav-flex">
        <div class="ui icon buttons vertical">
            <button id="showToc" class="ui purple button">目录</button>
            <a href="#leave-messsage" class="ui purple button">留言</a>
            <button id="showBlogQR" class="ui green button"><i class="icon wechat"></i></button>
            <button id="go-top" class="ui button"><i class="icon up chevron"></i></button>
        </div>
    </div>
    
    <!-- 文章目录 -->
    <div class="ui showToc flowing popup transition hidden" style="width: 200px !important;">
        <ol class="js-toc">
        </ol>
    </div>

    <!-- 文章二维码 -->
    <div class="ui flowing popup transition hidden showBlogQR" style="width: 150px !important; height: 150px !important;">
        <div class="ui violet basic label center aligned">
            <div id="blog-qrcode" class="ui image rounded">
                <!-- <img src="images/wechat.png" class="ui rounded bordered image" style="width: inherit; height: inherit;"> -->
            </div>
            <div style="padding-top: 0.4em !important; text-align: center !important;">
                扫码去微信阅读
            </div> 
        </div>
    </div>

    <!-- 底部 -->
    <div th:include="common :: copyright"></div>

    <!-- 关于我模态框 -->
    <div th:include="common :: aboutme"></div>
    
<!-- ------------------ js ------------------------------------------------------------------------------ -->
    <script src="../static/js/jquery.min.js" th:src="@{/res/js/jquery.min.js}"></script>
    <!-- <script src="js/flexible.js"></script> -->
    <script src="../static/js/semantic.min.js" th:src="@{/res/js/semantic.min.js}"></script>
    <script src="../static/lib/animate/jquery.animator-beta.min.js" th:src="@{/res/lib/animate/jquery.animator-beta.min.js}"></script>
    <script src="../static/lib/prism/prism.js" th:src="@{/res/lib/prism/prism.js}"></script>
    <script src="../static/lib/tocbot/tocbot.min.js" th:src="@{/res/lib/tocbot/tocbot.min.js}"></script>
    <script src="../static/lib/qrcode/qrcode.js" th:src="@{/res/lib/qrcode/qrcode.js}"></script>
    <script src="../static/lib/waypoint/jquery.waypoints.js" th:src="@{/res/lib/waypoint/jquery.waypoints.js}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.3/jquery.scrollTo.min.js"></script>
    <script src="../static/js/front.js" th:src="@{/res/js/front.js}"></script>

    <script type="text/javascript">
        function reply(ele) {
            $('#comment-form :input[name=content]').attr('placeholder', '@' + $(ele).data('replynickname'));
            $('#comment-form :input[name=content]').focus();
            $('#comment-form :input[name=comParentId]').attr('value', $(ele).data('comid'));
            var submit_result = $('#comment-form').form('validate form');
            if (submit_result) {
                postComment();
            }
        }
        function postComment() {
            $('#comment-fresh').load(/*[[@{/blog/comment/add}]]*/"/blog/comment/post", {
                'bid': $('#comment-form :input[name=bid]').val(),
                'comParentId': $('#comment-form :input[name=comParentId]').val(),
                'content': $('#comment-form :input[name=content]').val(),
                'nickname': $('#comment-form :input[name=nickname]').val(),
                'mail': $('#comment-form :input[name=mail]').val()
            }, function () {
                $('#comment-form :input[name=content]').val('');
                $('#comment-form :input[name=content]').attr('placeholder', '发表你的看法吧...');
                $('#comment-form :input[name=nickname]').val('');
                $('#comment-form :input[name=mail]').val('');
                $('#comment-form :input[name=comParentId]').attr('value', -1);
            });
        }
        $(function () {
            /*-------------- 加载留言 --------- */
            $('#comment').on('click', function () {
                $(this).attr('disabled', 'true');
                $('.m-show-comment').css('display', 'block');
                $(window).scrollTo('.m-show-comment', {duration: 300});
                $('#comment-fresh').load(/*[[@{/blog/comment/add}]]*/"/blog/comment/load/" + $(this).data('blogid'), function () {
                })
            });

            /*------------- 提交留言 ----------*/
            $('#comment-submit-btn').on('click',function () {
                var submit_result = $('#comment-form').form('validate form');
                if (submit_result) {
                    postComment();
                }
            });

            $('#comment-form').form({
                fields: {
                    content : {
                        identifier: 'content',
                        rules: [{
                            type: 'empty',
                            prompt: '请填写评论内容'
                        }]
                    },
                    nickname : {
                        identifier: 'nickname',
                        rules: [{
                            type: 'empty',
                            prompt: '请填写真实姓名'
                        }]
                    },
                    mail : {
                        identifier: 'mail',
                        rules: [{
                            type: 'email',
                            prompt: '请填写真实邮箱，供我们与您交流'
                        }]
                    }
                }
            });

            /*------------赞赏:显示二维码------------- */
            $('#appreciate').popup({
                popup : $('.showQR'),
                on    : 'click',
                position: 'bottom center'
            });
            /*------------点击侧边导航栏二维码按钮，显示文章对应的二维码------------- */
            $('#showBlogQR').popup({
                popup : $('.showBlogQR'),
                on    : 'click',
                position: 'top left'
            });
            /*----------使用qrcode动态生成每篇文章的二维码链接----------*/
            // blog-qrcode 表示显示二维码的容器【id】
            var readURL = "";
            var serverURl = "http://127.0.0.1:8080";
            var qrcode = new QRCode("blog-qrcode", {
                // text: "http://jindo.dev.naver.com/collie",
                text: location.href,
                width: 95,
                height: 95,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });
            /*----------tocboc初始化--------------*/
            tocbot.init({
                // 将生成的目录存放在以 class 为 js-toc 的容器中
                tocSelector: '.js-toc',
                // 指定以 class 为 js-toc-content 的容器中的内容需生成目录
                contentSelector: '.js-toc-content',
                // 指定哪些标签作为目录生成依据
                headingSelector: 'h1, h2, h3, h4',
                // For headings inside relative or absolute positioned containers within content.
                hasInnerContainers: true,
            });
            /*------------目录:显示文章目录------------- */
            $('#showToc').popup({
                popup : $('.showToc'),
                on    : 'click',
                position: 'top left'
            });
            /*----------tocboc初始化--------------*/
            tocbot.init({
                // 将生成的目录存放在以 class 为 js-toc 的容器中
                tocSelector: '.js-toc',
                // 指定以 class 为 js-toc-content 的容器中的内容需生成目录
                contentSelector: '.js-toc-content',
                // 指定哪些标签作为目录生成依据
                headingSelector: 'h1, h2, h3, h4',
                // For headings inside relative or absolute positioned containers within content.
                hasInnerContainers: true,
            });
            /*----------侧边快速工具栏移动检测----------*/
            var waypoint = new Waypoint({
                element: document.getElementById('waypoint'),
                handler: function(direction) {
                    if(direction == 'up') {
                        $("#toolbar").fadeOut("slow")
                    } else {
                        $("#toolbar").fadeIn("slow")
                    }
                }
            });
            /*-----------go top----------*/
            $("#go-top").on("click", function() {
                // $(document).scrollTop(0).slideDown("slow")
                $('html,body').animate({scrollTop: 0}, "slow");
            });
        })
    </script>

</body>
</html>